include: 'https://gitlab.gnome.org/GNOME/citemplates/raw/master/flatpak/flatpak_ci_initiative.yml'

stages:
  - check
  - build-flatpak
  - deploy

variables:
  BUNDLE: "gnome-music-dev.flatpak"
  APP_ID: "org.gnome.MusicDevel"
  FLATPAK_MODULE: "gnome-music"
  GIT_SUBMODULE_STRATEGY: normal
  MANIFEST_PATH: "org.gnome.Music.json"
  RUNTIME_REPO: "https://sdk.gnome.org/gnome-nightly.flatpakrepo"

flatpak:
    extends: .flatpak
    stage: build-flatpak
    variables:
        MESON_ARGS: "-Dprofile=development"

review:
    extends: .review
    dependencies:
        - flatpak

stop_review:
    extends: .stop_review

flake8:
  stage: check
  script:
    - dnf install -y python3-flake8
    - flake8 --ignore E402,W503 --show-source gnomemusic/
